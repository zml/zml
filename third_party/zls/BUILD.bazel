load("@rules_zig//zig:defs.bzl", "zig_binary")
load(":resolved_toolchain.bzl", "resolved_toolchain")

# This is the ZLS binary toolchain type. Zig rule authors should use this
# target in the `toolchains` parameter in order to access the appropriate ZLS
# binary for the current execution platform.
toolchain_type(
    name = "toolchain_type",
    visibility = ["//visibility:public"],
)

resolved_toolchain(
    name = "resolved_toolchain",
    # Marked manual so that `bazel test //...` passes
    # even if no toolchain is registered.
    tags = ["manual"],
    visibility = ["//visibility:public"],
)

exports_files(
    [
        "workspace_printer.zig",
        "zls_build_runner.zig",
        "zls_runner.zig",
        "zls.completion.tpl",
    ],
)

# Execute `bazel run //util:update_filegroups` to update this target.
filegroup(
    name = "all_files",
    srcs = [
        ":BUILD.bazel",
        ":zls.completion.tpl",
        ":zls_build_runner.zig",
        ":zls_completion.bzl",
        ":zls_runner.zig",
        ":zls_toolchain.bzl",
    ],
    visibility = ["@rules_zig//zig:__pkg__"],
)

zig_binary(
    name = "workspace_printer",
    main = "workspace_printer.zig",
)
